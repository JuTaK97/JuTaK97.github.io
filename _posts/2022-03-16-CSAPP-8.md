---
title : Computer Systems A Programmer's Perspective
categories : 
  - C
tags :
  - C
last_modified_at: 2020-03-16T21:13:00-05:00
---
# Chapter 8. Exceptional Control Flow
프로세서에 처음 전원을 공급할 때부터 전원을 끌 때까지, PC(program counter)는 일련의 값들을 따라 바뀌고, 각 값들은 수행할 instruction 각각의 주소가 된다. 
이러한 control transfer들을 _control flow_, 혹은 _flow of control_ 이라고 부른다.<br />
<br />
가장 간단한 형태의 control flow는 연속해서 수행하는 두 instruction이 메모리 상에서 인접한, "smooth"한 경우이다. 이런 smooth flow에 급격한 변화가 생기는 일은
jump, call, return과 같은 instruction에 의해 일어나고 이 때는 연속해서 수행되는 두 instruction이 메모리 상에서 인접하지 않는다. 이렇게 control flow에 변화를
주는 instruction들은 프로그램의 변수로 표현되는 internal program state의 변화에 프로그램이 반응하도록 하는 데 필수적이다.<br />
하지만 우리의 프로그램은 프로그램 내부의 변수들에 의해서만 program state가 바뀌지 않는다. 
- 하드웨어가 일정한 시간 간격으로 변해야 될 때도 있고, 
- 통신에서 패킷은 언제 도착할 지 모르며,
- 디스크에 요청한 데이터는 언제 로드가 완료될 지 모르고,
- parent process는 child process를 생성하고 나면 나중에 children이 종료될 때 notify 받아야 하는데, 언제 종료될 지는 아무도 모른다.

이런 상황에 반응해서 control flow에 abrupt change를 만들기 위해 _exceptional control flow_  를 만들었다. ECF는 computer system의 어떤 layer에서든 일어날 수 있는데,
하드웨어가 감지해서 abrupt control transfer를 만들기도 하고, 운영체제는 kernel이 process간에 context switch를 한다. 어플리케이션에서는 프로세스 간에 signal을 주고받으며
control transfer를 일으키기도 한다.<br />

이처럼 ECF는 꼭 뭔가 잘못된 에러 상황에서만 필요한 게 아니다. 
- ECF를 이해해야 I/O, 프로세스, 가상 메모리를 구현하기 위한 운영체제의 기본적인 매커니즘을 이해할 수 있고,
- 각 응용 프로그램들이 운영체제와 상호작용하는 것을 이해할 수 있다. 가장 대표적으로 모든 응용 프로그램은 디스크에서 데이터를 읽고 쓰고, 새 프로세스를 만들고 종료할 때
 _system call_  을 통해 커널을 호출하게 된다. 
- concurrency를 이해하기 위해서도 ECF의 이해는 필수적이다. (12장)
- 마지막으로, Java나 C++과 같은 응용 프로그램에서 exception의 동작 원리를 이해하기 위해서 ECF의 이해가 필요하다.

## 8.1 Exceptions
Exception은 일부는 하드웨어, 일부는 OS에 의해 수행되는 exceptional control flow이다. <br />
어떤 process의 _state_ 의 변화에 반응하는 control flow의 abrupt change이다. 이 _state_ 는 프로세서 내부에 여러 bit와 signal로 encode되어 있고, 이 _state_ 의 변화를 
 _event_ 라고 한다.
